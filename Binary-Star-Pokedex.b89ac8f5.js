window.PokedexSearchPanel=Panels.Panel.extend({minWidth:639,maxWidth:639,sidebarWidth:280,search:null,events:{"keyup input.searchbox":"updateSearch","change input.searchbox":"updateSearch","search input.searchbox":"updateSearch",submit:"submit",keydown:"keydown",keyup:"keyup",click:"click","click .result a":"clickResult","click .filter":"removeFilter","mouseover .result a":"hoverlink"},activeLink:null,initialize:function(){var e=this.fragment.slice(Config.baseurl.length-1),t=e.indexOf("?");"moves"===e&&(e="moves/"),"pokemon"===e&&(e="pokemon/"),"abilities"===e&&(e="abilities/"),"items"===e&&(e="items/"),"locations"===e&&(e="locations/"),"trainers"===e&&(e="trainers/"),"mechanics"===e&&(e="mechanics/"),t>=0&&(e=e.slice(0,t));var i='<div class="pfx-body"><form class="pokedex">';i+='<h1><a href="'+Config.baseurl+'"" data-target="replace">Pok&eacute;dex</a></h1>'+('<ul class="tabbar centered" style="margin-bottom: 18px"><li><button class="button nav-first'+(""===e?" cur":"")+'" value="'+Config.baseurl)+'">Search</button></li>'+('<li><button class="button'+("pokemon/"===e?" cur":"")+'" value="'+Config.baseurl)+'pokemon/">Pok&eacute;mon</button></li>'+('<li><button class="button'+("moves/"===e?" cur":"")+'" value="'+Config.baseurl)+'moves/">Moves</button></li>'+('<li><button class="button'+("abilities/"===e?" cur":"")+'" value="'+Config.baseurl)+'abilities/">Abilities</button></li>'+('<li><button class="button'+("items/"===e?" cur":"")+'" value="'+Config.baseurl)+'items/">Items</button></li>'+('<li><button class="button'+("mechanics/"===e?" cur":"")+'" value="'+Config.baseurl)+'mechanics/">Mechanics</button></li>'+('<li><button class="button'+("locations/"===e?" cur":"")+'" value="'+Config.baseurl)+'locations/">Locations</button></li>'+('<li><button class="button nav-last'+("trainers/"===e?" cur":"")+'" value="'+Config.baseurl)+'trainers/">Trainers</button></li></ul>'+('<div class="searchboxwrapper"><input class="textbox searchbox" type="search" name="q" value="'+escapeHTML(this.$(".searchbox").val()||""))+'" autocomplete="off" autofocus placeholder="Search Pok&eacute;mon, moves, abilities, items, types, or more" /></div>',""===e&&(i+='<p class="buttonbar"><button class="button"><strong>Pok&eacute;dex Search</strong></button> <button name="lucky" class="button">I\'m Feeling Lucky</button></p>'),i+='</form><div class="results"></div></div>',this.$el.html(i);var s=this.$(".searchbox");this.$searchbox=s,this.$searchfilters=null;var a=this.$(".results");if(a.length){var r=this.search=new BattleSearch(a,this.$el);if(this.$el.on("scroll",function(){r.updateScroll()}),"pokemon/"===e)r.setType("pokemon"),s.attr("placeholder","Search pokemon OR filter by type, move, ability, egg group"),this.$(".buttonbar").remove();else if("moves/"===e)r.setType("move"),s.attr("placeholder","Search moves OR filter by type, category, pokemon"),this.$(".buttonbar").remove();else if("abilities/"===e)r.setType("ability"),s.attr("placeholder","Search abilities OR filter by pokemon"),this.$(".buttonbar").remove();else if("items/"===e)r.setType("item"),s.attr("placeholder","Search items"),this.$(".buttonbar").remove();else if("mechanics/"===e){this.$(".buttonbar").remove(),this.$(".searchboxwrapper").remove();for(var o=[{id:"battlerules",name:"Battle Rules"},{id:"criticalhit",name:"Critical Hits"},{id:"gmaxmoves",name:"G-Max Moves"},{id:"grounded",name:"Grounded"},{id:"hazards",name:"Entry Hazards"},{id:"maxmoves",name:"Max Moves"},{id:"phazing",name:"Phazing"},{id:"submoves",name:"Substitute Moves"},{id:"terrain",name:"Terrain"},{id:"zmoves",name:"Z-Moves"}],n='<ul class="utilichart nokbd">',l=0;l<o.length;l++){var c=o[l];n+='<li class="result"><a href="'+Config.baseurl+"articles/"+c.id+'" data-target="push"><span class="col namecol">'+c.name+"</span></a></li>"}n+="</ul>",this.$(".results").html(n)}else"locations/"===e?(s.attr("placeholder","Search locations"),this.$(".buttonbar").remove(),this.$(".results").html('<p style="padding:20px;text-align:center;color:#999">Locations feature coming soon!</p>')):"trainers/"===e&&(s.attr("placeholder","Search trainers by name or id"),this.$(".buttonbar").remove(),this.trainersMode=!0,this.renderTrainers(""));this.search.externalFilter=!0}else this.search=null;s.focus(),this.find(s.val()),this.checkExactMatch()},updateSearch:function(e){this.find(e.currentTarget.value)},removeFilter:function(e){this.search.removeFilter(e),this.updateFilters(),this.$searchbox.focus()},updateFilters:function(){var e="";if("pokemon"===this.search.qType)e='<button class="filter noclear" value=":">Pok√©mon</button> ';else if("move"===this.search.qType)e='<button class="filter noclear" value=":">Moves</button> ';else if("ability"===this.search.qType)e='<button class="filter noclear" value=":">Abilities</button> ';else if("item"===this.search.qType)e='<button class="filter noclear" value=":">Items</button> ';else{this.$(".searchbox-filters").remove(),this.$searchbox.css("padding","2px");return}if(this.search.filters)for(var t=0;t<this.search.filters.length;t++){var i=this.search.filters[t],s=i[1];"move"===i[0]&&(s=getID(BattleMovedex,s).name),"pokemon"===i[0]&&(s=getID(BattlePokedex,s).name),e+='<button class="filter" value="'+escapeHTML(i.join(":"))+'">'+s+' <i class="fa fa-times-circle"></i></button> '}this.$searchfilters||(this.$searchfilters=$('<div class="searchbox-filters"></div>').insertAfter(this.$searchbox)),this.$searchfilters.html(e);var a=this.$searchfilters.width();a>this.$searchbox.outerWidth()/2?this.$searchbox.css("padding",""+(this.$searchfilters.height()+4)+"px 2px 2px 2px"):this.$searchbox.css("padding","2px 2px 2px "+(a+6)+"px")},submit:function(e){e.preventDefault(),this.$(".searchbox").attr("placeholder","Type in: Pokemon, move, item, ability...").focus()},keyup:function(e){var t=this.$searchbox.val(),i=toID(t);if(i){var s=t.charAt(t.length-1);if(","===s||" "===s){if("ds"===i||"dexsearch"===i||"pokemon"===i)return void this.app.go("pokemon/",this,!0);if("ms"===i||"movesearch"===i||"move"===i||"moves"===i)return void this.app.go("moves/",this,!0);if("as"===i||"abilitysearch"===i||"ability"===i||"abilities"===i)return void this.app.go("abilities/",this,!0)}if(","===s&&this.search.addFilter(this.activeLink)){this.$searchbox.val(""),this.find("");return}}},keydown:function(e){switch(e.keyCode){case 13:if(e.preventDefault(),e.stopPropagation(),this.search.addFilter(this.activeLink)){this.$searchbox.val(""),this.find("");return}if(this.activeLink){var t=this.activeLink.pathname.substr(1);if("moves/"===t||"pokemon/"===t)return void this.app.go(t,this,!0);this.app.go(t,this,!1,$(this.activeLink))}else this.$searchbox.val()||this.app.slicePanel(this);break;case 188:if(this.search.addFilter(this.activeLink)){e.preventDefault(),e.stopPropagation(),this.$searchbox.val(""),this.find("");return}break;case 32:var i=toID(this.$searchbox.val());if("ds"===i||"pokemon"===i){e.preventDefault(),e.stopPropagation(),this.app.go("pokemon/",this,!0);return}if("ms"===i||"move"===i||"moves"===i){e.preventDefault(),e.stopPropagation(),this.app.go("moves/",this,!0);return}if("as"===i||"ability"===i||"abilities"===i){e.preventDefault(),e.stopPropagation(),this.app.go("abilities/",this,!0);return}break;case 38:e.preventDefault(),e.stopPropagation();for(var s=$(this.activeLink).parent().prev();s[0]&&"A"!==s[0].firstChild.tagName;)s=s.prev();s[0]&&s.children()[0]&&($(this.activeLink).removeClass("active"),this.activeLink=s.children()[0],$(this.activeLink).addClass("active"));break;case 40:e.preventDefault(),e.stopPropagation();for(var s=$(this.activeLink).parent().next();s[0]&&"A"!==s[0].firstChild.tagName;)s=s.next();s[0]&&s.children()[0]&&($(this.activeLink).removeClass("active"),this.activeLink=s.children()[0],$(this.activeLink).addClass("active"));break;case 27:case 8:if(this.$searchbox.val())break;if(this.search.removeFilter())return void this.find("");if(this.search.qType)return void this.app.go("",this,!0);this.app.panels.length>1&&(e.preventDefault(),e.stopPropagation(),this.app.slicePanel(this))}},click:function(e){if("BUTTON"===e.target.tagName&&$(e.target).closest(".tabbar").length){e.preventDefault(),e.stopPropagation(),this.app.go(e.target.value,this,!0);return}if("BUTTON"===e.target.tagName&&"lucky"===e.target.name){e.preventDefault(),e.stopPropagation(),alert(["That's pretty cool.","Your mom's feeling lucky.","I see.","If you feel lucky for more than four hours, perhaps you should see a doctor."][Math.floor(4*Math.random())]);return}var t=this.$el.scrollTop();this.$searchbox.focus(),this.$el.scrollTop(t)},clickResult:function(e){if(this.search.addFilter(e.currentTarget)){e.preventDefault(),e.stopImmediatePropagation(),this.$searchbox.val(""),this.find("");return}},hoverlink:function(e){$(this.activeLink).removeClass("active"),this.activeLink=e.currentTarget,$(this.activeLink).addClass("active")},find:function(e){this.trainersMode?this.renderTrainers(e||""):!this.search||(e||(e=""),this.updateFilters(),this.search.find(e)&&(this.search.q||this.search.filters?(this.$(".pokedex").addClass("aboveresults"),this.activeLink=this.search.el.getElementsByTagName("a")[0],$(this.activeLink).addClass("active")):(this.$(".pokedex").removeClass("aboveresults"),this.activeLink=null)))},renderTrainers:function(e){e=(e||"").toLowerCase();let t=window.Trainers||[],i='<ul class="utilichart nokbd">';for(let s=0;s<t.length;s++){let a=t[s],r="["+a.id+"] "+escapeHTML(a.name);if(e&&-1===r.toLowerCase().indexOf(e))continue;let o=(a.team||[]).map(e=>escapeHTML(e.name)+" (Lv. "+(e.level||"?")+")").join(", ");i+='<li class="result"><a href="'+Config.baseurl+"trainers/"+a.id+'" data-target="push"><span class="col namecol">'+r+'</span><span class="col smallcol">$'+(a.prizeMoney||0)+'</span><span class="col">'+o+"</span></a></li>"}i+="</ul>",this.$(".results").html(i),this.$(".pokedex").addClass("aboveresults"),this.activeLink=this.$(".results a")[0]||null,this.activeLink&&$(this.activeLink).addClass("active")},checkExactMatch:function(){this.search&&this.search.exactMatch&&"metronome"!==this.search.q&&"psychic"!==this.search.q&&setTimeout((function(){this.app.go($(this.activeLink).attr("href"),this,!1,$(this.activeLink),!0)}).bind(this))}});
//# sourceMappingURL=Binary-Star-Pokedex.b89ac8f5.js.map
